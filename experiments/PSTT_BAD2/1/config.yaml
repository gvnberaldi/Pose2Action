# Configurations for model training
dataset: 'BAD2'
split: '/sets_0-8_7.txt'
device_args: 1
device_args: 0,1,2,3
seed: 0
model: 'PSTTransformer'
wandb_project: 'ar4pc_ev'
val_set: false

# input
clip_len: 24
frame_interval: 1
max_frame_interval: 20
num_points: 2048

# P4D
radius: 0.3
nsamples: 32
spatial_stride: 32
temporal_kernel_size: 3
temporal_stride: 2

# transformer
dim: 80
depth: 5
heads: 82
dim_head: 40
mlp_dim: 160

dropout1: 0.0 #transformer dropout
dropout2: 0.0 #classifier dropout

# training
batch_size: 14
epochs: 50
workers: 10
lr: 0.01
momentum: 0.9
weight_decay: 1e-4
lr_milestones:
  - 20
  - 30
lr_gamma: 0.1
lr_warmup_epochs: 10
# output
log_dir: "log"
    # resume
resume: ''
start_epoch: 0
    # losses
loss_type: 'weighted_cross_entropy'   # choices=['std_cross_entropy', 'weighted_cross_entropy', 'focal'],
save: True

DS_AUGMENTS_CFG:
  - name: CropPtsAug
    p_prob: 0.0
    p_max_pts: 1500
    p_crop_ratio: 1
    p_apply_extra_tensors:
      - false
      - false

  - name: RotationAug
    p_prob: 0.0
    p_axis: 1
    p_min_angle: 0.0
    p_max_angle: 6.28318530718
    p_apply_extra_tensors:
      - false
      - false

  - name: RotationAug
    p_prob: 0.0
    p_axis: 0
    p_min_angle: -0.1308996939
    p_max_angle: 0.1308996939
    p_apply_extra_tensors:
      - false
      - false

  - name: RotationAug
    p_prob: 1.0
    p_axis: 2
    p_min_angle: -0.1308996939
    p_max_angle: 0.1308996939
    p_apply_extra_tensors:
      - false
      - false

  - name: NoiseAug
    p_prob: 1.0
    p_stddev: 0.005
    p_clip: 0.02
    p_apply_extra_tensors:
      - false
      - false

  - name: LinearAug
    p_prob: 1.0
    p_min_a: 0.9
    p_max_a: 1.1
    p_min_b: 0.0
    p_max_b: 0.0
    p_channel_independent: true
    p_apply_extra_tensors:
      - false
      - false

  - name: MirrorAug
    p_prob: 1.0
    p_mirror_prob: 0.5
    p_axes:
      - true
      - true
      - false
    p_apply_extra_tensors:
      - false
      - false